DevZendo.org Macro Assembler 0.0.1-SNAPSHOT                                                                      18/09/2018 18:41:05
Transputer Hello World                                                                                                    Page 1 - 4
                      TITLE Transputer Hello World
                      
                      PAGE 60,132
                      
                      ; Second version without macros.
                      ; Where does this get loaded into memory, when sent via the bootstrap protocol?
                      ; Don't I need a length byte?
                      
                      .T800
 = 0070               MemStart    EQU 0x80000070
 = 0024               TptrLoc0    EQU 0x80000024
 = 0028               TptrLoc1    EQU 0x80000028
                      
 = 0000               start_time  EQU 0
                      
 = 006F               ORG         MemStart - 1
 8000006F DA          DB          STOP - START
 = 0070               ORG         MemStart
                      
 80000070             START:
 80000070 24 F2       mint                        ; load A with NotProcess.p = mint = 0x80000000
 80000072 21 F8       sthf                        ; initialize high priority queue front pointer
 80000074 24 F2       mint                        ; load A with NotProcess.p
 80000076 21 FC       stlf                        ; initialize low priority process queue pointer
 80000078 24 F2       mint                        ; load A with NotProcess.p
                      ldc     TPtrLoc0            ; load high priority timer queue pointer offset
 8000007B E0          stnl    0                   ; initialize high priority timer queue
 8000007C 24 F2       mint                        ; load A with NotProcess.p
                      ldc     TPtrLoc1            ; load low priority timer queue pointer offset
 8000007F E0          stnl    0                   ; initialize high priority timer queue
 80000080 40          ldc     start_time          ; load time to initialize clocks at (usually zero)
 80000081 25 F4       sttimer                     ; start the clocks
 80000083 22 F9       testerr                     ; clears the Error flag
 80000085 25 F7       clrhalterr                  ; or use sethalterr here depending what you want
 80000087 24 F2       mint                        ; load A with NotProcess.p
 80000089 67 20 20 20 ldc     0x80000020          ; load address of Event channel
 8000008D 20 20 22 40
 80000091 E0          stnl    0                   ; store NotProcess.p to Event channel
 80000092 24 F2       mint                        ; load A with NotProcess.p
 80000094 67 20 20 20 ldc     0x8000001C          ; load address of Link 3 input channel
 80000098 20 20 21 4C
 8000009C E0          stnl    0                   ; store NotProcess.p to Link 3 input channel
 8000009D 24 F2       mint                        ; load A with NotProcess.p
 8000009F 67 20 20 20 ldc     0x80000018          ; load address of Link 2 input channel
 800000A3 20 20 21 48
 800000A7 E0          stnl    0                   ; store NotProcess.p to Link 2 input channel
 800000A8 24 F2       mint                        ; load A with NotProcess.p
 800000AA 67 20 20 20 ldc     0x80000014          ; load address of Link 1 input channel
 800000AE 20 20 21 44
 800000B2 E0          stnl    0                   ; store NotProcess.p to Link 1 input channel
 800000B3 24 F2       mint                        ; load A with NotProcess.p
 800000B5 67 20 20 20 ldc     0x80000010          ; load address of Link 0 input channel
 800000B9 20 20 21 40
 800000BD E0          stnl    0                   ; store NotProcess.p to Link 0 input channel
 800000BE 24 F2       mint                        ; load A with NotProcess.p
 800000C0 67 20 20 20 ldc     0x8000000C          ; load address of Link 3 output channel
 800000C4 20 20 20 4C
 800000C8 E0          stnl    0                   ; store NotProcess.p to Link 3 output channel
DevZendo.org Macro Assembler 0.0.1-SNAPSHOT                                                                      18/09/2018 18:41:05
Transputer Hello World                                                                                                    Page 2 - 4
 800000C9 24 F2       mint                        ; load A with NotProcess.p
 800000CB 67 20 20 20 ldc     0x80000008          ; load address of Link 2 output channel
 800000CF 20 20 20 48
 800000D3 E0          stnl    0                   ; store NotProcess.p to Link 2 output channel
 800000D4 24 F2       mint                        ; load A with NotProcess.p
 800000D6 67 20 20 20 ldc     0x80000004          ; load address of Link 1 output channel
 800000DA 20 20 20 44
 800000DE E0          stnl    0                   ; store NotProcess.p to Link 1 output channel
 800000DF 24 F2       mint                        ; load A with NotProcess.p
 800000E1 67 20 20 20 ldc     0x80000000          ; load address of Link 0 output channel
 800000E5 20 20 20 40
 800000E9 E0          stnl    0                   ; store NotProcess.p to Link 0 output channel
                      
                      
                      
                      j   MAIN - ST1
 800000EB             ST1:
                      
 800000EB             HWSTR:
 800000EB 68 65 6C 6C DB  "hello world", 0x0a, 0x00 ; length 13
 800000EF 6F 20 77 6F
 800000F3 72 6C 64 0A
 800000F7 00
                      
 800000F8             MAIN:
                      ldc HWSTR - LF5
 800000F9 21 FB       ldpi
 800000FB             LF5:
                      ; call _putConsoleCString
                      call _putConsoleCString - LF6
 800000FC             LF6:
                      
 800000FC             FIN:
 800000FC 21 F5       stopp
                      
 800000FE             _putConsoleCString:
 800000FE 60 B7       ajw -9
 80000100 40          ldc 0
 80000101 D3          stl 3
 80000102 11          ldlp 1
 80000103 D4          stl 4
 80000104 73          ldl 3
 80000105 74          ldl 4
 80000106 23 FB       sb
 80000108 7A          ldl 10
                      call _strlen - PCCS1
 8000010A             PCCS1:
 8000010A D2          stl 2
 8000010B 24 F2       mint
 8000010D D5          stl 5
 8000010E 21 20 42    ldc 258
 80000111 D6          stl 6
 80000112 75          ldl 5
 80000113 76          ldl 6
 80000114 FF          outword
                      
 80000115 24 F2       mint
 80000117 D7          stl 7
DevZendo.org Macro Assembler 0.0.1-SNAPSHOT                                                                      18/09/2018 18:41:05
Transputer Hello World                                                                                                    Page 3 - 4
 80000118 7A          ldl 10
 80000119 77          ldl 7
 8000011A 72          ldl 2
 8000011B FB          out
                      
 8000011C 24 F2       mint
 8000011E D8          stl 8
 8000011F 78          ldl 8
 80000120 71          ldl 1
 80000121 FE          outbyte
 80000122 B9          ajw 9
 80000123 22 F0       ret
                      
 80000125             _strlen:
 80000125 60 BA       ajw -6
 80000127 40          ldc 0
 80000128 D1          stl 1
 80000129 71          ldl 1
 8000012A D0          stl 0
 8000012B             LS1:
 8000012B 77          ldl 7
 8000012C D2          stl 2
 8000012D 72          ldl 2
 8000012E F1          lb
 8000012F D3          stl 3
 80000130 73          ldl 3
 80000131 C0          eqc 0
                      cj LS3
                      j LS2
 80000134             LS3:
 80000134 70          ldl 0
 80000135 81          adc 1
 80000136 D4          stl 4
 80000137 74          ldl 4
 80000138 D0          stl 0
 80000139 77          ldl 7
 8000013A 81          adc 1
 8000013B D5          stl 5
 8000013C 75          ldl 5
 8000013D D7          stl 7
 8000013E 67 20 20 20 j LS1
 80000142 20 21 22 0B
 80000146             LS2:
 80000146 70          ldl 0
 80000147 B6          ajw 6
 80000148 22 F0       ret
                      
 8000014A             STOP:
                      END









DevZendo.org Macro Assembler 0.0.1-SNAPSHOT                                                                      18/09/2018 18:41:05
Transputer Hello World                                                                                                    Page 4 - 4
Symbol Table - by Name
FIN                  800000FC
HWSTR                800000EB
LF5                  800000FB
LF6                  800000FC
LS1                  8000012B
LS2                  80000146
LS3                  80000134
MAIN                 800000F8
MemStart             80000070
PCCS1                8000010A
ST1                  800000EB
START                80000070
STOP                 8000014A
TptrLoc0             80000024
TptrLoc1             80000028
_putConsoleCString   800000FE
_strlen              80000125
start_time           00000000

Symbol Table - by Address
TptrLoc0             80000024
TptrLoc1             80000028
START                80000070
MemStart             80000070
ST1                  800000EB
HWSTR                800000EB
MAIN                 800000F8
LF5                  800000FB
LF6                  800000FC
FIN                  800000FC
_putConsoleCString   800000FE
PCCS1                8000010A
_strlen              80000125
LS1                  8000012B
LS3                  80000134
LS2                  80000146
STOP                 8000014A
start_time           00000000



















