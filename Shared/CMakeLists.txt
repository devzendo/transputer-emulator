if(WIN32)
    set(platform_sources namedpipelink.cpp namedpipelink.h)
endif(WIN32)
if(UNIX)
    set(platform_sources fifolink.cpp fifolink.h)
endif(UNIX)
add_library(parachutedev STATIC log.h log.cpp misc.h misc.cpp hexdump.h hexdump.cpp link.h link.cpp "${platform_sources}" linkfactory.h linkfactory.cpp constants.h emuquery.h memloc.h platformdetection.h types.h stublink.cpp stublink.h)

add_executable(testtypes testtypes.cpp)
target_link_libraries(testtypes gtest gmock_main)
add_test(NAME testtypes COMMAND testtypes)

add_executable(testlink testlink.cpp)
target_link_libraries(testlink parachutedev gtest gmock_main)
add_test(NAME testlink COMMAND testlink)
